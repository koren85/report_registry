<div class="report-issues-wrapper">
  <div id="issues-table-container" class="box">
    <div class="issues-table-header">
      <h3><%= l(:label_report_issues) %></h3>
      <% if @project %>
        <%= link_to l(:button_add_issues),
                    modal_issues_report_report_issues_path(@report || @project.reports.new),
                    class: 'button icon icon-add',
                    remote: true,
                    'data-modal': true %>
      <% end %>
    </div>

    <table class="list issues-list">
      <thead>
      <tr>
        <th class="sortable" data-sort="id">#</th>
        <th class="sortable" data-sort="subject"><%= l(:field_subject) %></th>
        <th class="sortable" data-sort="status"><%= l(:field_status) %></th>
        <th class="sortable" data-sort="project"><%= l(:field_project) %></th>
        <th class="sortable" data-sort="fixed_version_id"><%= l(:field_version) %></th>
        <th class="sortable" data-sort="start_date"><%= l(:field_start_date) %></th>
        <th class="sortable" data-sort="due_date"><%= l(:field_due_date) %></th>
        <th class="sortable" data-sort="parent_id"><%= l(:field_parent_issue) %></th>
        <th class="sortable" data-sort="custom_field_value">
          <%= Setting.plugin_report_registry['custom_field_name'] %>
        </th>
        <th class="buttons"></th>
      </tr>
      </thead>
      <tbody id="report-issues-body">
      <%= render 'report_issues/issues_list' if @report&.persisted? %>
      </tbody>
    </table>
  </div>
</div>

<% content_for :header_tags do %>
  <%= javascript_include_tag 'issues_table', plugin: 'report_registry' %>
  <%= stylesheet_link_tag 'issues_table', plugin: 'report_registry' %>
  <%= stylesheet_link_tag 'modal_window', plugin: 'report_registry' %>
<% end %>